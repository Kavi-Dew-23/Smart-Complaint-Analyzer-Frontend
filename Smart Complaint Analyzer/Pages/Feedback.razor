@page "/"
@inject ModelApiService ApiService
<link href="/css/Styles.css" rel="stylesheet" />

<div class="analyzer-container">
    <div class="analyzer-box">
        <h2>✈️ Smart Complaint Analyzer</h2>

        <textarea @bind="feedbackText" rows="4" cols="60" placeholder="Enter passenger feedback here..."></textarea>
        <br />
        <button class="analyze-btn" @onclick="AnalyzeFeedback">Analyze</button>

        @if (loading)
        {
            <p>Analyzing...</p>
        }
        @if (!string.IsNullOrEmpty(resultText))
        {
            <p class="result">@resultText</p>
        }
    </div>
</div>

@code {
    string feedbackText = "";
    bool loading = false;
    string resultText = "";

    async Task AnalyzeFeedback()
    {
        loading = true;
        resultText = "";
        try
        {
            var resp = await ApiService.PredictAsync(feedbackText);
            resultText = $"Label: {resp.Label} (confidence: {resp.Score:P1})";
        }
        catch (Exception ex)
        {
            resultText = "Error: " + ex.Message;
        }
        finally
        {
            loading = false;
        }
    }
}
